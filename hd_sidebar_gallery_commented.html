<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ° Labubué«˜æ¸…å£çº¸ç”»å»Š - 400+ç²¾é€‰æ”¶è—</title>
    <style>
        /* ========================================
           åŸºç¡€æ ·å¼é‡ç½®å’Œå…¨å±€è®¾ç½®
        ======================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            margin: 0;
            display: flex; /* ä½¿ç”¨flexå¸ƒå±€æ”¯æŒä¾§è¾¹æ  */
        }

        /* ========================================
           ä¾§è¾¹æ æ ·å¼
        ======================================== */
        .sidebar {
            width: 280px; /* ä¾§è¾¹æ å›ºå®šå®½åº¦ */
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px); /* æ¯›ç»ç’ƒæ•ˆæœ */
            box-shadow: 2px 0 20px rgba(0,0,0,0.1);
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            overflow-y: hidden; /* éšè—æ»šåŠ¨æ¡ */
            z-index: 1000;
            padding: 25px 20px;
            transition: transform 0.3s ease; /* æ”¶èµ·å±•å¼€åŠ¨ç”» */
        }

        /* ä¾§è¾¹æ æ”¶èµ·çŠ¶æ€ */
        .sidebar.collapsed {
            transform: translateX(-280px); /* å®Œå…¨éšè— */
        }

        /* ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’® */
        .sidebar-toggle {
            position: fixed;
            left: 240px; /* é»˜è®¤ä½ç½®åœ¨ä¾§è¾¹æ å³ä¾§ */
            top: 20px;
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            font-size: 20px;
            z-index: 1001; /* ç¡®ä¿åœ¨ä¾§è¾¹æ ä¹‹ä¸Š */
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #667eea;
            font-weight: bold;
        }

        /* ä¾§è¾¹æ æ”¶èµ·æ—¶æŒ‰é’®æ ·å¼ */
        .sidebar.collapsed + .sidebar-toggle {
            left: 20px; /* ç§»åŠ¨åˆ°å·¦ä¸Šè§’ */
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .sidebar-toggle:hover {
            transform: scale(1.1);
        }

        /* ========================================
           ä¸»å†…å®¹åŒºåŸŸæ ·å¼
        ======================================== */
        .main-content {
            flex: 1;
            margin-left: 280px; /* ä¸ºä¾§è¾¹æ ç•™å‡ºç©ºé—´ */
            transition: margin-left 0.3s ease;
        }

        /* ä¾§è¾¹æ æ”¶èµ·æ—¶ä¸»å†…å®¹åŒºå æ»¡å±å¹• */
        .main-content.expanded {
            margin-left: 0;
        }

        /* é¡¶éƒ¨æ ‡é¢˜æ  */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .title {
            text-align: center;
            margin-bottom: 0;
        }

        .title h1 {
            font-size: 2rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }

        .title p {
            margin: 5px 0 0 0;
            font-size: 0.9rem;
            color: #666;
        }

        /* ========================================
           ä¾§è¾¹æ å†…å®¹æ ·å¼
        ======================================== */
        .sidebar-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
            height: 100%;
        }

        /* ä¾§è¾¹æ å¡ç‰‡æ ·å¼ */
        .sidebar-section {
            background: rgba(255, 255, 255, 0.6);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.8);
        }

        .sidebar-section h3 {
            margin: 0 0 20px 0;
            font-size: 1.2rem;
            color: #333;
            font-weight: 600;
            text-align: center;
        }

        /* ========================================
           åˆ†ç±»ç­›é€‰æŒ‰é’®æ ·å¼
        ======================================== */
        .controls {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .filter-btn {
            padding: 15px 20px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            color: #555;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            width: 100%;
            text-align: center;
            font-size: 0.95rem;
            border: 2px solid transparent;
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            background: rgba(255, 255, 255, 0.95);
        }

        /* æ¿€æ´»çŠ¶æ€çš„ç­›é€‰æŒ‰é’® */
        .filter-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        /* ========================================
           åˆ†é¡µæ§åˆ¶æ ·å¼
        ======================================== */
        .pagination-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            align-items: center;
        }

        /* é¡µé¢å¤§å°é€‰æ‹©å™¨ */
        .page-size-selector {
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: center;
            width: 100%;
        }

        .page-size-selector label {
            font-weight: 600;
            color: #555;
            font-size: 0.95rem;
        }

        .page-size-selector select {
            padding: 12px 16px;
            border-radius: 25px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            background: rgba(255,255,255,0.9);
            font-weight: 600;
            color: #555;
            width: 100%;
            text-align: center;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-size-selector select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* åˆ†é¡µå¯¼èˆªæŒ‰é’® */
        .page-navigation {
            display: flex;
            gap: 12px;
            align-items: center;
            width: 100%;
        }

        .page-btn {
            padding: 12px 18px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            color: #555;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            font-size: 0.85rem;
            flex: 1;
            border: 2px solid transparent;
        }

        .page-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
            background: rgba(200, 200, 200, 0.5);
        }

        /* é¡µé¢ä¿¡æ¯æ˜¾ç¤º */
        .page-info {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
            text-align: center;
            margin: 8px 0;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(255,255,255,0.2);
        }

        /* ========================================
           ç”»å»Šå±•ç¤ºåŒºåŸŸæ ·å¼
        ======================================== */
        .gallery {
            padding: 20px;
        }

        /* ç€‘å¸ƒæµå¸ƒå±€å®¹å™¨ */
        .masonry-container {
            column-count: 4; /* é»˜è®¤4åˆ— */
            column-gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ç”»å»Šé¡¹ç›®æ ·å¼ */
        .gallery-item {
            break-inside: avoid; /* é˜²æ­¢ç€‘å¸ƒæµé¡¹ç›®è¢«åˆ†å‰² */
            margin-bottom: 20px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.25);
        }

        .gallery-item img, .gallery-item video {
            width: 100%;
            height: auto;
            display: block;
            transition: transform 0.3s ease;
        }

        .gallery-item:hover img, .gallery-item:hover video {
            transform: scale(1.05);
        }

        /* é¡¹ç›®ä¿¡æ¯åŒºåŸŸ */
        .item-info {
            padding: 15px;
            background: white;
        }

        .item-title {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2; /* é™åˆ¶æ˜¾ç¤º2è¡Œ */
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .item-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        /* æ ‡ç­¾æ ·å¼ */
        .tag {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
        }

        /* ä¸åŒåˆ†ç±»çš„æ ‡ç­¾é¢œè‰² */
        .tag.fantasy { background: linear-gradient(45deg, #667eea, #764ba2); }
        .tag.desktop { background: linear-gradient(45deg, #f093fb, #f5576c); }
        .tag.mobile { background: linear-gradient(45deg, #4facfe, #00f2fe); }
        .tag.seasonal { background: linear-gradient(45deg, #43e97b, #38f9d7); }
        .tag.live { background: linear-gradient(45deg, #fa709a, #fee140); }
        .tag.k4 { background: linear-gradient(45deg, #a8edea, #fed6e3); color: #333; }

        /* è§†é¢‘æŒ‡ç¤ºå™¨ */
        .video-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* åŠ è½½å¤±è´¥å ä½ç¬¦ */
        .loading-placeholder {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-weight: bold;
        }

        /* ========================================
           æ¨¡æ€æ¡†æ ·å¼
        ======================================== */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.9);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            position: relative;
            margin: auto;
            padding: 20px;
            width: 90%;
            max-width: 1200px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .modal img, .modal video {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .modal-info {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: center;
            max-width: 600px;
        }

        /* å…³é—­æŒ‰é’® */
        .close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            z-index: 2001;
        }

        .close:hover {
            color: #ccc;
        }

        /* ä¸‹è½½æŒ‰é’® */
        .download-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        /* ========================================
           å“åº”å¼è®¾è®¡
        ======================================== */
        @media (max-width: 1200px) {
            .masonry-container { column-count: 3; }
            .sidebar { width: 260px; }
            .main-content { margin-left: 260px; }
            .sidebar-toggle { left: 220px; }
            .sidebar.collapsed { transform: translateX(-260px); }
            .sidebar.collapsed + .sidebar-toggle { left: 20px; }
        }

        @media (max-width: 768px) {
            .masonry-container { column-count: 2; }
            .title h1 { font-size: 1.8rem; }
            .sidebar { 
                width: 100%; 
                transform: translateX(-100%);
            }
            .sidebar.show { 
                transform: translateX(0); 
            }
            .sidebar.collapsed {
                transform: translateX(-100%);
            }
            .main-content { margin-left: 0; }
            .main-content.expanded { margin-left: 0; }
            .sidebar-toggle { 
                left: 20px; 
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
            }
        }

        @media (max-width: 480px) {
            .masonry-container { column-count: 1; }
            .gallery { padding: 15px; }
            .header { padding: 10px 15px; }
            .sidebar { padding: 20px 15px; }
        }

        /* ========================================
           å·¥å…·ç±»æ ·å¼
        ======================================== */
        .hidden {
            display: none;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2rem;
        }

        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- ========================================
         ä¾§è¾¹æ å¯¼èˆªåŒºåŸŸ
    ======================================== -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-content">
            <!-- åˆ†ç±»ç­›é€‰å¡ç‰‡ -->
            <div class="sidebar-section">
                <h3>ğŸ¯ åˆ†ç±»ç­›é€‰</h3>
                <div class="controls">
                    <!-- ç­›é€‰æŒ‰é’®ï¼šdata-filterå±æ€§ç”¨äºJavaScriptç­›é€‰é€»è¾‘ -->
                    <button class="filter-btn active" data-filter="all">ğŸ“‚ å…¨éƒ¨ä½œå“</button>
                    <button class="filter-btn" data-filter="fantasy">ğŸŒŸ å¥‡å¹»ä¸–ç•Œ</button>
                    <button class="filter-btn" data-filter="desktop">ğŸ’» æ¡Œé¢å£çº¸</button>
                    <button class="filter-btn" data-filter="mobile">ğŸ“± æ‰‹æœºå£çº¸</button>
                    <button class="filter-btn" data-filter="seasonal">ğŸŒ¸ å­£èŠ‚ä¸»é¢˜</button>
                    <button class="filter-btn" data-filter="4k">ğŸ¬ 4Kè¶…æ¸…</button>
                    <button class="filter-btn" data-filter="live">ğŸ¥ åŠ¨æ€å£çº¸</button>
                </div>
            </div>

            <!-- åˆ†é¡µæ§åˆ¶å¡ç‰‡ -->
            <div class="sidebar-section">
                <h3>ğŸ“„ åˆ†é¡µå¯¼èˆª</h3>
                <div class="pagination-controls">
                    <!-- é¡µé¢å¤§å°é€‰æ‹©å™¨ -->
                    <div class="page-size-selector">
                        <label>æ¯é¡µæ˜¾ç¤ºæ•°é‡</label>
                        <select id="pageSizeSelect">
                            <option value="24">24 ä¸ªä½œå“</option>
                            <option value="36" selected>36 ä¸ªä½œå“</option>
                            <option value="48">48 ä¸ªä½œå“</option>
                            <option value="60">60 ä¸ªä½œå“</option>
                        </select>
                    </div>
                    <!-- å½“å‰é¡µé¢ä¿¡æ¯æ˜¾ç¤º -->
                    <div class="page-info">
                        ç¬¬ <span id="currentPage">1</span> é¡µ / å…± <span id="totalPages">1</span> é¡µ
                    </div>
                    <!-- åˆ†é¡µå¯¼èˆªæŒ‰é’® -->
                    <div class="page-navigation">
                        <button class="page-btn" id="prevBtn">â† ä¸Šä¸€é¡µ</button>
                        <button class="page-btn" id="nextBtn">ä¸‹ä¸€é¡µ â†’</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’® -->
    <button class="sidebar-toggle" id="sidebarToggle" title="æ”¶èµ·ä¾§è¾¹æ ">âœ•</button>

    <!-- ========================================
         ä¸»å†…å®¹åŒºåŸŸ
    ======================================== -->
    <div class="main-content" id="mainContent">
        <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
        <div class="header">
            <div class="title">
                <h1>ğŸ° Labubué«˜æ¸…å£çº¸ç”»å»Š</h1>
                <p>ç²¾é€‰400+é«˜æ¸…å£çº¸ Â· çœŸæ­£çš„4Kç”»è´¨ä½“éªŒ</p>
            </div>
        </div>

        <!-- ç”»å»Šå±•ç¤ºåŒºåŸŸ -->
        <div class="gallery">
            <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
            <div class="loading" id="loadingIndicator">
                <div class="spinner"></div>
                æ­£åœ¨åŠ è½½é«˜æ¸…å£çº¸...
            </div>
            <!-- ç€‘å¸ƒæµç”»å»Šå®¹å™¨ -->
            <div class="masonry-container" id="galleryContainer"></div>
        </div>
    </div>

    <!-- ========================================
         æ¨¡æ€æ¡† - ç”¨äºå…¨å±é¢„è§ˆå›¾ç‰‡/è§†é¢‘
    ======================================== -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <!-- å…³é—­æŒ‰é’® -->
            <span class="close">&times;</span>
            <!-- å›¾ç‰‡é¢„è§ˆ -->
            <img id="modalImage" src="" alt="">
            <!-- è§†é¢‘é¢„è§ˆ -->
            <video id="modalVideo" controls style="display: none;"></video>
            <!-- æ¨¡æ€æ¡†ä¿¡æ¯åŒºåŸŸ -->
            <div class="modal-info">
                <h3 id="modalTitle"></h3>
                <div id="modalTags"></div>
                <button class="download-btn" id="downloadBtn">ä¸‹è½½é«˜æ¸…åŸå›¾</button>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥é«˜æ¸…ç”»å»Šæ•°æ®æ–‡ä»¶ -->
    <script src="hd_gallery_data.js"></script>
    <script>
        /**
         * ========================================
         * Labubué«˜æ¸…å£çº¸ç”»å»Šä¸»ç±»
         * ========================================
         * åŠŸèƒ½ï¼š
         * - ç®¡ç†400+é«˜æ¸…å£çº¸å’Œè§†é¢‘çš„å±•ç¤º
         * - æä¾›åˆ†ç±»ç­›é€‰åŠŸèƒ½
         * - å®ç°æ™ºèƒ½åˆ†é¡µåŠ è½½
         * - æ”¯æŒå“åº”å¼å¸ƒå±€
         * - è§†é¢‘ç¼©ç•¥å›¾ç”Ÿæˆ
         * - æ¨¡æ€æ¡†é¢„è§ˆå’Œä¸‹è½½
         */
        class HDLabubuGallery {
            /**
             * æ„é€ å‡½æ•° - åˆå§‹åŒ–ç”»å»Š
             */
            constructor() {
                // ä»å¤–éƒ¨æ•°æ®æ–‡ä»¶åŠ è½½æ‰€æœ‰åª’ä½“é¡¹ç›®
                this.allItems = hdImageData || [];
                // å½“å‰ç­›é€‰åçš„é¡¹ç›®åˆ—è¡¨
                this.filteredItems = [...this.allItems];
                // å½“å‰æ¿€æ´»çš„ç­›é€‰å™¨
                this.currentFilter = 'all';
                // å½“å‰é¡µç 
                this.currentPage = 1;
                // æ¯é¡µæ˜¾ç¤ºçš„é¡¹ç›®æ•°é‡
                this.pageSize = 36;
                // æ€»é¡µæ•°
                this.totalPages = 1;
                
                // åˆå§‹åŒ–ç”»å»Š
                this.init();
            }

            /**
             * åˆå§‹åŒ–æ–¹æ³• - è®¾ç½®äº‹ä»¶ç›‘å¬å™¨å’Œåˆå§‹çŠ¶æ€
             */
            init() {
                this.setupEventListeners();
                this.filterItems('all');
                this.hideLoading();
            }

            /**
             * è®¾ç½®æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨
             */
            setupEventListeners() {
                // ========================================
                // ä¾§è¾¹æ åˆ‡æ¢åŠŸèƒ½
                // ========================================
                const sidebarToggle = document.getElementById('sidebarToggle');
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');

                sidebarToggle.addEventListener('click', () => {
                    // åˆ‡æ¢ä¾§è¾¹æ æ˜¾ç¤º/éšè—çŠ¶æ€
                    sidebar.classList.toggle('collapsed');
                    mainContent.classList.toggle('expanded');
                    
                    // æ›´æ–°æŒ‰é’®å›¾æ ‡å’Œæç¤ºæ–‡å­—
                    if (sidebar.classList.contains('collapsed')) {
                        sidebarToggle.innerHTML = 'â˜°';
                        sidebarToggle.title = 'å±•å¼€ä¾§è¾¹æ ';
                    } else {
                        sidebarToggle.innerHTML = 'âœ•';
                        sidebarToggle.title = 'æ”¶èµ·ä¾§è¾¹æ ';
                    }
                });

                // ========================================
                // åˆ†ç±»ç­›é€‰æŒ‰é’®äº‹ä»¶
                // ========================================
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const filter = e.target.dataset.filter;
                        this.filterItems(filter);
                    });
                });

                // ========================================
                // åˆ†é¡µæ§åˆ¶äº‹ä»¶
                // ========================================
                
                // ä¸Šä¸€é¡µæŒ‰é’®
                document.getElementById('prevBtn').addEventListener('click', () => {
                    if (this.currentPage > 1) {
                        this.currentPage--;
                        this.renderGallery();
                    }
                });

                // ä¸‹ä¸€é¡µæŒ‰é’®
                document.getElementById('nextBtn').addEventListener('click', () => {
                    if (this.currentPage < this.totalPages) {
                        this.currentPage++;
                        this.renderGallery();
                    }
                });

                // é¡µé¢å¤§å°é€‰æ‹©å™¨
                document.getElementById('pageSizeSelect').addEventListener('change', (e) => {
                    this.pageSize = parseInt(e.target.value);
                    this.currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
                    this.renderGallery();
                });

                // ========================================
                // æ¨¡æ€æ¡†äº‹ä»¶å¤„ç†
                // ========================================
                const modal = document.getElementById('imageModal');
                const closeBtn = document.querySelector('.close');
                
                // å…³é—­æŒ‰é’®ç‚¹å‡»äº‹ä»¶
                closeBtn.addEventListener('click', () => {
                    modal.style.display = 'none';
                    this.pauseModalVideo();
                });

                // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
                window.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                        this.pauseModalVideo();
                    }
                });

                // ========================================
                // é”®ç›˜å¯¼èˆªæ”¯æŒ
                // ========================================
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        // ESCé”®å…³é—­æ¨¡æ€æ¡†
                        modal.style.display = 'none';
                        this.pauseModalVideo();
                    } else if (e.key === 'ArrowLeft' && this.currentPage > 1) {
                        // å·¦ç®­å¤´é”®ï¼šä¸Šä¸€é¡µ
                        this.currentPage--;
                        this.renderGallery();
                    } else if (e.key === 'ArrowRight' && this.currentPage < this.totalPages) {
                        // å³ç®­å¤´é”®ï¼šä¸‹ä¸€é¡µ
                        this.currentPage++;
                        this.renderGallery();
                    }
                });

                // ========================================
                // å“åº”å¼å¤„ç†
                // ========================================
                this.handleResponsive();
                window.addEventListener('resize', () => this.handleResponsive());
            }

            /**
             * å“åº”å¼å¸ƒå±€å¤„ç†
             * æ ¹æ®å±å¹•å°ºå¯¸è‡ªåŠ¨è°ƒæ•´ä¾§è¾¹æ çŠ¶æ€
             */
            handleResponsive() {
                const sidebar = document.getElementById('sidebar');
                const mainContent = document.getElementById('mainContent');
                const sidebarToggle = document.getElementById('sidebarToggle');
                
                if (window.innerWidth <= 768) {
                    // ç§»åŠ¨ç«¯ï¼šé»˜è®¤æ”¶èµ·ä¾§è¾¹æ 
                    sidebar.classList.add('collapsed');
                    mainContent.classList.add('expanded');
                    sidebarToggle.innerHTML = 'â˜°';
                    sidebarToggle.title = 'å±•å¼€ä¾§è¾¹æ ';
                } else if (window.innerWidth > 768) {
                    // æ¡Œé¢ç«¯ï¼šé»˜è®¤å±•å¼€ä¾§è¾¹æ 
                    sidebar.classList.remove('collapsed');
                    mainContent.classList.remove('expanded');
                    sidebarToggle.innerHTML = 'âœ•';
                    sidebarToggle.title = 'æ”¶èµ·ä¾§è¾¹æ ';
                }
            }

            /**
             * ç­›é€‰é¡¹ç›®
             * @param {string} filter - ç­›é€‰ç±»å‹ ('all', 'fantasy', 'desktop', ç­‰)
             */
            filterItems(filter) {
                this.currentFilter = filter;
                this.currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ

                // æ›´æ–°ç­›é€‰æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-filter="${filter}"]`).classList.add('active');

                // æ ¹æ®ç­›é€‰æ¡ä»¶è¿‡æ»¤æ•°æ®
                if (filter === 'all') {
                    // æ˜¾ç¤ºæ‰€æœ‰é¡¹ç›®
                    this.filteredItems = [...this.allItems];
                } else if (filter === 'live') {
                    // åªæ˜¾ç¤ºè§†é¢‘æ–‡ä»¶
                    this.filteredItems = this.allItems.filter(item => item.type === 'video');
                } else if (filter === '4k') {
                    // æ˜¾ç¤º4Kåˆ†è¾¨ç‡çš„é¡¹ç›®
                    this.filteredItems = this.allItems.filter(item => 
                        item.category === '4k' || item.resolution === '4K'
                    );
                } else {
                    // æŒ‰åˆ†ç±»ç­›é€‰
                    this.filteredItems = this.allItems.filter(item => 
                        item.category === filter
                    );
                }

                // é‡æ–°æ¸²æŸ“ç”»å»Š
                this.renderGallery();
            }

            /**
             * æ¸²æŸ“ç”»å»Šå†…å®¹
             * å¤„ç†åˆ†é¡µé€»è¾‘å¹¶ç”ŸæˆHTMLå…ƒç´ 
             */
            renderGallery() {
                const container = document.getElementById('galleryContainer');
                
                // ========================================
                // è®¡ç®—åˆ†é¡µä¿¡æ¯
                // ========================================
                this.totalPages = Math.ceil(this.filteredItems.length / this.pageSize);
                const startIndex = (this.currentPage - 1) * this.pageSize;
                const endIndex = startIndex + this.pageSize;
                const currentItems = this.filteredItems.slice(startIndex, endIndex);

                // æ›´æ–°åˆ†é¡µä¿¡æ¯æ˜¾ç¤º
                document.getElementById('currentPage').textContent = this.currentPage;
                document.getElementById('totalPages').textContent = this.totalPages;
                
                // æ›´æ–°åˆ†é¡µæŒ‰é’®çŠ¶æ€
                document.getElementById('prevBtn').disabled = this.currentPage === 1;
                document.getElementById('nextBtn').disabled = this.currentPage === this.totalPages;

                // ========================================
                // æ¸²æŸ“ç”»å»Šé¡¹ç›®
                // ========================================
                container.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹

                currentItems.forEach((item, index) => {
                    const itemElement = this.createGalleryItem(item, startIndex + index);
                    container.appendChild(itemElement);
                });

                // å¹³æ»‘æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            /**
             * åˆ›å»ºå•ä¸ªç”»å»Šé¡¹ç›®å…ƒç´ 
             * @param {Object} item - åª’ä½“é¡¹ç›®æ•°æ®
             * @param {number} index - é¡¹ç›®ç´¢å¼•
             * @returns {HTMLElement} ç”»å»Šé¡¹ç›®DOMå…ƒç´ 
             */
            createGalleryItem(item, index) {
                const div = document.createElement('div');
                div.className = 'gallery-item';
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶æ‰“å¼€æ¨¡æ€æ¡†
                div.addEventListener('click', () => this.openModal(item));

                const isVideo = item.type === 'video';
                const mediaElement = isVideo ? 'video' : 'img';
                const videoIndicator = isVideo ? '<div class="video-indicator">ğŸ¬ åŠ¨æ€</div>' : '';

                // ç”Ÿæˆåˆ†ç±»æ ‡ç­¾
                const tags = this.generateTags(item);

                // æ„å»ºHTMLç»“æ„
                div.innerHTML = `
                    ${videoIndicator}
                    <${mediaElement} 
                        src="${item.url}" 
                        alt="${item.title}"
                        loading="lazy"
                        ${isVideo ? 'preload="metadata" muted' : ''}
                        onerror="this.parentElement.querySelector('.loading-placeholder').style.display='flex'; this.style.display='none';"
                    ></${mediaElement}>
                    <div class="loading-placeholder" style="display: none;">
                        åŠ è½½å¤±è´¥
                    </div>
                    <div class="item-info">
                        <div class="item-title">${item.title}</div>
                        <div class="item-tags">${tags}</div>
                    </div>
                `;

                // ä¸ºè§†é¢‘ç”Ÿæˆç¼©ç•¥å›¾
                if (isVideo) {
                    this.generateVideoThumbnail(div.querySelector('video'), div);
                }

                return div;
            }

            /**
             * ç”Ÿæˆé¡¹ç›®æ ‡ç­¾HTML
             * @param {Object} item - åª’ä½“é¡¹ç›®æ•°æ®
             * @returns {string} æ ‡ç­¾HTMLå­—ç¬¦ä¸²
             */
            generateTags(item) {
                const tags = [];
                
                // åˆ†ç±»æ ‡ç­¾
                if (item.category) {
                    const categoryMap = {
                        'fantasy': 'å¥‡å¹»',
                        'desktop': 'æ¡Œé¢',
                        'mobile': 'æ‰‹æœº',
                        'seasonal': 'å­£èŠ‚',
                        '4k': '4K',
                        'live': 'åŠ¨æ€'
                    };
                    const categoryName = categoryMap[item.category] || item.category;
                    tags.push(`<span class="tag ${item.category}">${categoryName}</span>`);
                }

                // åˆ†è¾¨ç‡æ ‡ç­¾
                if (item.resolution && item.resolution !== item.category) {
                    tags.push(`<span class="tag k4">${item.resolution}</span>`);
                }

                return tags.join('');
            }

            /**
             * ä¸ºè§†é¢‘ç”Ÿæˆç¼©ç•¥å›¾
             * ä½¿ç”¨Canvas APIä»è§†é¢‘ç¬¬1ç§’æå–å¸§ä½œä¸ºç¼©ç•¥å›¾
             * @param {HTMLVideoElement} video - è§†é¢‘å…ƒç´ 
             * @param {HTMLElement} container - å®¹å™¨å…ƒç´ 
             */
            generateVideoThumbnail(video, container) {
                video.addEventListener('loadeddata', () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    // è®¾ç½®ç”»å¸ƒå°ºå¯¸ä¸è§†é¢‘ç›¸åŒ
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    
                    // è·³è½¬åˆ°ç¬¬1ç§’
                    video.currentTime = 1;
                    
                    video.addEventListener('seeked', () => {
                        // å°†è§†é¢‘å¸§ç»˜åˆ¶åˆ°ç”»å¸ƒ
                        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                        
                        // åˆ›å»ºç¼©ç•¥å›¾imgå…ƒç´ 
                        const img = document.createElement('img');
                        img.src = canvas.toDataURL();
                        img.alt = video.alt;
                        img.loading = 'lazy';
                        img.style.width = '100%';
                        img.style.height = 'auto';
                        img.style.display = 'block';
                        
                        // æ›¿æ¢è§†é¢‘å…ƒç´ ä¸ºç¼©ç•¥å›¾
                        video.style.display = 'none';
                        video.parentNode.insertBefore(img, video);
                    }, { once: true });
                });
            }

            /**
             * æ‰“å¼€æ¨¡æ€æ¡†é¢„è§ˆ
             * @param {Object} item - è¦é¢„è§ˆçš„åª’ä½“é¡¹ç›®
             */
            openModal(item) {
                const modal = document.getElementById('imageModal');
                const modalImage = document.getElementById('modalImage');
                const modalVideo = document.getElementById('modalVideo');
                const modalTitle = document.getElementById('modalTitle');
                const modalTags = document.getElementById('modalTags');
                const downloadBtn = document.getElementById('downloadBtn');

                // è®¾ç½®æ¨¡æ€æ¡†å†…å®¹
                modalTitle.textContent = item.title;
                modalTags.innerHTML = this.generateTags(item);

                if (item.type === 'video') {
                    // æ˜¾ç¤ºè§†é¢‘
                    modalImage.style.display = 'none';
                    modalVideo.style.display = 'block';
                    modalVideo.src = item.url;
                } else {
                    // æ˜¾ç¤ºå›¾ç‰‡
                    modalVideo.style.display = 'none';
                    modalImage.style.display = 'block';
                    modalImage.src = item.url;
                }

                // è®¾ç½®ä¸‹è½½æŒ‰é’®
                downloadBtn.onclick = () => this.downloadFile(item.url, item.title);

                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                modal.style.display = 'block';
            }

            /**
             * æš‚åœæ¨¡æ€æ¡†ä¸­çš„è§†é¢‘æ’­æ”¾
             */
            pauseModalVideo() {
                const modalVideo = document.getElementById('modalVideo');
                if (!modalVideo.paused) {
                    modalVideo.pause();
                }
            }

            /**
             * ä¸‹è½½æ–‡ä»¶
             * @param {string} url - æ–‡ä»¶URL
             * @param {string} filename - æ–‡ä»¶å
             */
            downloadFile(url, filename) {
                const a = document.createElement('a');
                a.href = url;
                a.download = filename + '.' + url.split('.').pop();
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }

            /**
             * éšè—åŠ è½½æŒ‡ç¤ºå™¨
             */
            hideLoading() {
                document.getElementById('loadingIndicator').style.display = 'none';
            }
        }

        /**
         * ========================================
         * åº”ç”¨ç¨‹åºå…¥å£ç‚¹
         * ========================================
         * å½“DOMåŠ è½½å®Œæˆååˆå§‹åŒ–ç”»å»Š
         */
        document.addEventListener('DOMContentLoaded', () => {
            new HDLabubuGallery();
        });
    </script>
</body>
</html>
